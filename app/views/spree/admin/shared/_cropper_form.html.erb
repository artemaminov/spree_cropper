<%#= content_for :head do %>
<%#= javascript_include_tag 'rcrop/rcrop.min' %>
<%#= javascript_include_tag 'spree/backend/cropper' %>
<%#= stylesheet_link_tag 'rcrop/rcrop.min' %>
<%# end %>

<%= image_tag(main_app.url_for(resource.attachment), { id: 'source', style: 'max-width: 100%;', data: { devices: Spree::CropperDevice.dimensions } }) %>
<div id="targets"></div>
<div id="previews"></div>
<button type="button" id="values">Get values</button>
  <% if resource.croppers.exists? %>
    <%= cropped_image_fields.fields_for :croppers do |croppers_fields| %>
      <%= render partial: 'spree/admin/shared/cropper_fields', locals: { croppers_fields: croppers_fields, device: croppers_fields.object.name } %>
    <% end %>
  <% else %>
    <% Spree::CropperDevice.dimensions.count.times do |i| %>
      <%= cropped_image_fields.fields_for 'croppers_attributes[]', Spree::Cropper.new do |croppers_fields| %>
        <%# byebug %>
        <%= render partial: 'spree/admin/shared/cropper_fields', locals: { croppers_fields: croppers_fields, device: Spree::CropperDevice.dimensions.keys[i].to_s } %>
      <% end %>
    <% end %>
  <% end %>
<br/>
<span>Values:</span>
<span id="results"></span>
